{% extends 'admin/nav.html' %}

{% block title %}
<title>C E | Manage Product Category</title>
{% endblock %}

{% block body_block %}

<style>
    /* Match Manage Products Tech Look */
    .tech-container {
        background: #ffffff;
        border-radius: 14px;
        padding: 25px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.08);
        border: 1px solid #e9ecef;
    }

    h2 {
        font-weight: 600;
        letter-spacing: 0.5px;
    }

    .table thead {
        background: #f8fafc;
        border-bottom: 2px solid #dee2e6;
    }

    .table tbody tr:hover {
        background: #f1f5f9 !important;
        transition: 0.2s;
    }

    .search-box {
        max-width: 280px;
    }

    .btn-tech {
        border-radius: 8px;
        font-weight: 500;
    }
</style>

<section class="container-fluid mt-4">
    <div class="container tech-container">

        <!-- Header + Search -->
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-center mb-3 gap-3">
            <h2 class="mb-0">
                <i class="bi bi-folder2-open"></i> Manage Product Category
            </h2>

            <form method="GET" action="" class="d-flex flex-row gap-2 w-md-auto">
                <input type="text" name="search" class="form-control search-box"
                       placeholder="Search category..." value="{{ request.GET.search }}">
                <button type="submit" class="btn btn-primary px-4 btn-tech">
                    <i class="bi bi-search"></i>
                </button>
            </form>
        </div>

        <hr>

        {% if PDO %}
        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Category Name</th>
                        <th>Image</th>
                        <th>Edit</th>
                        <th>Delete</th>
                    </tr>
                </thead>

                <tbody>
                    {% for pdo in PDO %}
                    <tr>
                        <td class="fw-bold">{{ pdo.pctid }}</td>
                        <td>{{ pdo.pctname }}</td>

                        <td>
                            {% if pdo.pimage %}
                                <img src="{{ pdo.pimage.url }}" class="rounded"
                                     style="max-width:50px; max-height:50px;">
                            {% else %}
                                <span class="text-muted fst-italic">No Image</span>
                            {% endif %}
                        </td>

                        <td>
                            <a href="{% url 'editproductcategory' pctid=pdo.pctid %}"
                               class="btn btn-warning btn-sm btn-tech">
                                <i class="bi bi-pencil-square"></i>
                            </a>
                        </td>

                        <td>
                            <a href="{% url 'delete_product_category' pid=pdo.pctid %}"
                               class="btn btn-danger btn-sm btn-tech"
                               onclick="return confirm('Are you sure you want to delete this category?')">
                                <i class="bi bi-trash3"></i>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center flex-wrap gap-1">

                {% if PDO.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?search={{ request.GET.search }}&page=1">&laquo; First</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?search={{ request.GET.search }}&page={{ PDO.previous_page_number }}">Previous</a>
                </li>
                {% endif %}

                <li class="page-item disabled">
                    <span class="page-link">Page {{ PDO.number }} of {{ PDO.paginator.num_pages }}</span>
                </li>

                {% if PDO.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?search={{ request.GET.search }}&page={{ PDO.next_page_number }}">Next</a>
                </li>

                <li class="page-item">
                    <a class="page-link"
                       href="?search={{ request.GET.search }}&page={{ PDO.paginator.num_pages }}">
                       Last &raquo;
                    </a>
                </li>
                {% endif %}
            </ul>
        </nav>

        {% else %}
        <div class="alert alert-warning text-center fw-bold">
            No Product Categories Found
        </div>
        {% endif %}

    </div>
</section>

{% endblock %}
